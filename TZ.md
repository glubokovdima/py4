–í–æ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø–ª–∞–Ω –∏–∑ –ø—è—Ç–∏ —à–∞–≥–æ–≤, —á—Ç–æ–±—ã —à–∞–≥ –∑–∞ —à–∞–≥–æ–º —Å–¥–µ–ª–∞—Ç—å –≤–∞—à—É —Å–∏—Å—Ç–µ–º—É —á—É—Ç—å –ª—É—á—à–µ:

1. **–ü–æ—á–∏—Å—Ç–∏—Ç—å ¬´—à—É–º–Ω—ã–µ¬ª –ø—Ä–∏–∑–Ω–∞–∫–∏**

   * –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ –∏–∑ –≤–∞—à–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ñ–∏—á–µ–π) –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–≥–Ω–æ–∑, –∞ –∫–∞–∫–∏–µ ‚Äî –ø–æ—á—Ç–∏ –Ω–µ—Ç.
   * –û—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ, –∞ ¬´–º—É—Å–æ—Ä–Ω—ã–µ¬ª —É–¥–∞–ª–∏—Ç–µ. –¢–∞–∫ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —É—á–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ –∏ —Ç–æ—á–Ω–µ–µ.

2. **–£—á–µ—Å—Ç—å —Ä–∞–∑–Ω—É—é —á–∞—Å—Ç–æ—Ç—É —Å–∏–≥–Ω–∞–ª–æ–≤**

   * –í —Ç–∞—Ä–≥–µ—Ç–µ —É –≤–∞—Å –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ—Ç–∫–∏ (–º–Ω–æ–≥–æ ‚Äú–Ω–µ–π—Ç—Ä–∞–ª–æ–≤‚Äù –∏ –º–∞–ª–æ —Å–∏–ª—å–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π).
   * –î–∞–π—Ç–µ ‚Äú–≤–∞–∂–Ω—ã–º‚Äù –∏ —Ä–µ–¥–∫–∏–º –∫–ª–∞—Å—Å–∞–º –±–æ–ª—å—à–∏–π –≤–µ—Å –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ ‚Äî —Ç–æ–≥–¥–∞ –º–æ–¥–µ–ª—å —Å—Ç–∞–Ω–µ—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ –∫ —Ä–µ–¥–∫–∏–º, –Ω–æ —Ü–µ–Ω–Ω—ã–º —Å–∏–≥–Ω–∞–ª–∞–º.

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (learning rate)**

   * –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–∞–≤–∏—Ç—å –ø–æ–º–µ–Ω—å—à–µ: 0.05 –∏–ª–∏ –¥–∞–∂–µ 0.03 –≤–º–µ—Å—Ç–æ 0.1.
   * –ß–µ–º –º–µ–Ω—å—à–µ —Å–∫–æ—Ä–æ—Å—Ç—å, —Ç–µ–º –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ –º–æ–¥–µ–ª—å ‚Äú—à–∞–≥–∞–µ—Ç‚Äù –∫ –æ–ø—Ç–∏–º—É–º—É, –Ω–æ —Ç–µ–º –±–æ–ª—å—à–µ –¥–µ—Ä–µ–≤—å–µ–≤ –Ω—É–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å.

4. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –¥–µ—Ä–µ–≤—å–µ–≤**

   * –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É —Å ¬´—Ä–∞–Ω–Ω–µ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π¬ª (early stopping): –º–æ–¥–µ–ª—å —Å–∞–º–∞ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç —É—á–∏—Ç—å—Å—è, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç —É–ª—É—á—à–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω–æ–π —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.
   * –¢–∞–∫ –≤—ã –Ω–µ –ø–µ—Ä–µ–±–æ—Ä—â–∏—Ç–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏—Ç–µ—Ä–∞—Ü–∏–π –∏ –Ω–µ –ø–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö**

   * –û—Ç–ª–æ–∂–∏—Ç–µ —á–∞—Å—Ç—å –∏—Å—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ–¥–Ω–∏–µ 15 %) –∏ –Ω–µ —Ç—Ä–æ–≥–∞–π—Ç–µ –µ—ë –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.
   * –ü–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–∞–≤–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –Ω–∞ —ç—Ç–æ–π ¬´–æ—Ç–ª–æ–∂–∫–µ¬ª ‚Äî —Ç–∞–∫ —É–≤–∏–¥–∏—Ç–µ, —Ä–µ–∞–ª—å–Ω–æ –ª–∏ —Å–∏—Å—Ç–µ–º–∞ —É–ª—É—á—à–∏–ª–∞—Å—å.

---

üîß **–ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ**

* –û—Ç–∫—Ä–æ–π—Ç–µ —Å–≤–æ–π –∫–æ–¥, –≥–¥–µ –≤—ã –æ–±—É—á–∞–µ—Ç–µ CatBoost.
* –í–∫–ª—é—á–∏—Ç–µ –≤—ã–≤–æ–¥ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Ñ–∏—á (feature importance) –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–æ–ø-20.
* –í –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö `CatBoostClassifier` –¥–æ–±–∞–≤—å—Ç–µ `class_weights`, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –ø–æ –æ–±—Ä–∞—Ç–Ω–æ–π —á–∞—Å—Ç–æ—Ç–µ –∫–ª–∞—Å—Å–æ–≤.
* –£–º–µ–Ω—å—à–∏—Ç–µ `learning_rate` –∏ –¥–æ–±–∞–≤—å—Ç–µ `early_stopping_rounds=50`.
* –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –º–µ—Ç—Ä–∏–∫—É –Ω–∞ ¬´–æ—Ç–ª–æ–∂–∫–µ¬ª –¥–æ –∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–∞–º —Å—Ç–∞–Ω–µ—Ç ¬´—Ç–µ—Å–Ω–æ¬ª –ø–æ –∫–∞—á–µ—Å—Ç–≤—É ‚Äî —Ç–æ–≥–¥–∞ —É–∂–µ –º–æ–∂–Ω–æ –ø—Ä–æ–±–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ —Ç—Ä—é–∫–∏ (–±–ª–µ–Ω–¥–∏–Ω–≥, —Å—Ç—ç–∫–∏–Ω–≥ –∏ –¥—Ä—É–≥–∏–µ –∞–Ω—Å–∞–º–±–ª–∏). –ù–æ —Å–Ω–∞—á–∞–ª–∞ —ç—Ç–∏ –±–∞–∑–æ–≤—ã–µ —à–∞–≥–∏ –¥–∞–¥—É—Ç –≤–∞–º —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –∏ –∑–∞–º–µ—Ç–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç.



//


–ù–∏–∂–µ ‚Äî –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω, –∫–∞–∫ –∏–∑ –≤–∞—à–µ–≥–æ –±–æ–≥–∞—Ç–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Ñ–∏—á–µ–π) ¬´–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å¬ª —Å–∞–º—ã–µ —Å–∏–ª—å–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã –≤–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π, –∞ –ª–∏—à–Ω–∏–µ —É–±—Ä–∞—Ç—å. –Ø –æ–ø–∏—Ä–∞—é—Å—å –Ω–∞ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –∏ –æ–ø—ã—Ç —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞/–∏–Ω—Ç—Ä–∞–¥–µ–π-—Ç—Ä–µ–π–¥–∏–Ω–≥–∞.

---

## –®–∞–≥ 1. –°–æ–±—Ä–∞—Ç—å –±–∞–∑–æ–≤—É—é –≤–∞–∂–Ω–æ—Å—Ç—å –ø–æ CatBoost

1.1. **OOF-–≤–∞–∂–Ω–æ—Å—Ç—å**

* –í–æ –≤—Ä–µ–º—è CV (5 —Ñ–æ–ª–¥–æ–≤) —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ out-of-fold –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Äî feature importance –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ:

  ```python
  fi_oof = []
  for train_idx, val_idx in kf.split(X, y):
      clf = CatBoostClassifier(...).fit(X.iloc[train_idx], y.iloc[train_idx],
                                        eval_set=(X.iloc[val_idx], y.iloc[val_idx]),
                                        early_stopping_rounds=50)
      fi_oof.append(clf.get_feature_importance())
  mean_fi = np.mean(fi_oof, axis=0)
  ```
* –≠—Ç–æ –¥–∞—Å—Ç –≤–∞–º **—Å—Ç–∞–±–∏–ª—å–Ω—É—é** –∫–∞—Ä—Ç–∏–Ω—É –≤–∞–∂–Ω–æ—Å—Ç–∏, –±–µ–∑ –ø–µ—Ä–µ–∫–æ—Å–∞ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ .

1.2. **–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥**

* –ü–æ—Å—Ç—Ä–æ–π—Ç–µ Series –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Ç–æ–ø-30 —Ñ–∏—á:

  ```python
  import pandas as pd
  fi = pd.Series(mean_fi, index=feature_cols).sort_values(ascending=False)
  display(fi.head(30))
  ```
* –°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ –ø–µ—Ä–≤—ã—Ö 10‚Äì15 ‚Äî —ç—Ç–æ –≤–∞—à–∏ ¬´–æ—Å–Ω–æ–≤–Ω—ã–µ¬ª –¥–≤–∏–∂—É—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã.

---

## –®–∞–≥ 2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å SHAP-—Ü–µ–Ω–Ω–æ—Å—Ç–∏

2.1. **–ü–æ—á–µ–º—É SHAP?**

* –û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ ‚Äú–∫—Ç–æ –≤–∞–∂–µ–Ω‚Äù, –Ω–æ –∏ –≤ –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É (‚Üë/‚Üì) –≤–ª–∏—è–µ—Ç.

2.2. **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**

```python
from catboost import Pool
import shap

pool = Pool(X_train, y_train)
explainer = shap.TreeExplainer(clf_final)
shap_values = explainer.shap_values(pool)
shap.summary_plot(shap_values, X_train)
```

* –ù–∞ –∏–Ω—Ç—Ä–∞–¥–µ–π-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö (1 –º, 5 –º, 15 –º) –∏—â–∏—Ç–µ —Ñ–∏—á–∏ —Å –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ ¬´–∫—Ä–∞—Å–Ω—ã–π/—Å–∏–Ω–∏–π¬ª ‚Äî –æ–Ω–∏ —Ä–µ–∞–ª—å–Ω–æ —Å–∏–≥–Ω–∞–ª—è—Ç –æ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞—Ö –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–∏ –∏–º–ø—É–ª—å—Å–∞.

---

## –®–∞–≥ 3. –ü–µ—Ä–º—É—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å (Permutation Importance)

3.1. **–ú–µ—Ç–æ–¥**

* –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç–µ —Å—Ç–æ–ª–±–µ—Ü –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —É—Ö—É–¥—à–∏–ª–∞—Å—å –º–µ—Ç—Ä–∏–∫–∞ (accuracy/MAE).

3.2. **–ö–æ–¥**

```python
perm_imp = clf_final.get_feature_importance(
    data=Pool(X_test, y_test),
    type='PredictionValuesChange'
)
perm_series = pd.Series(perm_imp, index=feature_cols).sort_values(ascending=False)
```

* –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –µ—Å–ª–∏ perm-–≤–∞–∂–Ω–æ—Å—Ç—å –±–ª–∏–∑–∫–∞ –∫ –Ω—É–ª—é ‚Äî —ç—Ç–æ—Ç –ø—Ä–∏–∑–Ω–∞–∫ –º–æ–∂–Ω–æ —Å–º–µ–ª–æ –≤—ã–∫–∏–¥—ã–≤–∞—Ç—å .

---

## –®–∞–≥ 4. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏

4.1. **–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π**

```python
corr = X_train.corr().abs()
upper = corr.where(np.triu(np.ones(corr.shape), k=1).astype(bool))
to_drop = [col for col in upper.columns if any(upper[col] > 0.85)]
```

* –£–±–µ—Ä–∏—Ç–µ –∏–∑ `to_drop` —Ç–µ, —á—Ç–æ –æ–∫–∞–∑–∞–ª–∏—Å—å –≤ —Ç–æ–ø-15 –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏.
* –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö ‚Äî –æ—Å—Ç–∞–≤—å—Ç–µ –æ–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫-¬´–ª–∏–¥¬ª –≤ –≥—Ä—É–ø–ø–µ.

---

## –®–∞–≥ 5. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ ¬´–Ω—É–ª–µ–≤—ã—Ö¬ª —Ñ–∏—á–µ–π

5.1. **–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –æ—Ç–±–æ—Ä (RFE-–ø–æ–¥—Ö–æ–¥)**

* –ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤—ã–∫–∏–¥—ã–≤–∞–π—Ç–µ 5‚Äì10 —Å–∞–º—ã—Ö –Ω–∏–∑–∫–æ –≤–∞–∂–Ω—ã—Ö —Ñ–∏—á, –ø–µ—Ä–µ–æ–±—É—á–∞–π—Ç–µ –º–æ–¥–µ–ª—å, —Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∞ –Ω–∞ hold-out (15 %).

5.2. **–ö—Ä–∏—Ç–µ—Ä–∏–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**

* –ï—Å–ª–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è ¬´—Ö–≤–æ—Å—Ç–∞¬ª –∏–∑ 20 —Ñ–∏—á –º–µ—Ç—Ä–∏–∫–∞ —É—Ö—É–¥—à–∏–ª–∞—Å—å –º–µ–Ω–µ–µ —á–µ–º –Ω–∞ 0.5‚Äì1 % ‚Äî –¥–∞–ª—å—à–µ –º–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å ¬´–º—É—Å–æ—Ä¬ª, –ø–æ–∫–∞ –ø–∞–¥–µ–Ω–∏–µ –Ω–µ —Å—Ç–∞–Ω–µ—Ç –∑–Ω–∞—á–∏–º—ã–º.

---

## –®–∞–≥ 6. –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –∫—Ä–∏–ø—Ç–æ –∏–Ω—Ç—Ä–∞–¥–µ–π

* **–¢–§ 1 –º‚Äì15 –º**: –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ñ–∏—á–∏, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –Ω–∞ —ç—Ç–∏—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö (VWAP, –æ–±—ä–µ–º–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä (OBV), EMA 20/50 –Ω–∞ 1 –º –∏ 5 –º).
* **–ò—Å–∫–ª—é—á–∏—Ç–µ ¬´–¥–Ω–µ–≤–Ω—ã–µ¬ª —Ñ–∏—á–∏** (–¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, —á–∞—Å). –û–Ω–∏ –≤ –∏–Ω—Ç—Ä–∞–¥–µ–µ —Ä–µ–¥–∫–æ –ø–æ–º–æ–≥–∞—é—Ç.
* **–î–æ–±–∞–≤—å—Ç–µ order-book-–º–µ—Ç—Ä–∏–∫–∏**, –µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø: –≥–ª—É–±–∏–Ω–∞ —Å—Ç–∞–∫–∞–Ω–∞, —Å–ø—Ä–µ–¥ ‚Äî —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–æ –ø–µ—Ä–≤—ã–º–∏ —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ ¬´–∫–∏–≤–æ–∫¬ª –º–∞—Ä–∫–µ—Ç–º–µ–π–∫–µ—Ä–æ–≤.

---

## –®–∞–≥ 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∫–∞–ª—å–ø-—Å–µ—Å—Å–∏—è—Ö

1. **Back-test** —Å –Ω–æ–≤–æ–π —É—Ä–µ–∑–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–¥–µ–ª—å intraday.
2. **Live-trade** –Ω–∞ –¥–µ–º–æ-—Å—á—ë—Ç–µ: —Å—Ä–∞–≤–Ω–∏—Ç–µ –∫–æ–ª-–≤–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ PnL –¥–æ/–ø–æ—Å–ª–µ.
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∫–æ—Ä–æ—Å—Ç–∏**: —á–µ–º –º–µ–Ω—å—à–µ —Ñ–∏—á ‚Äî —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ inference, –∞ –∑–Ω–∞—á–∏—Ç ‚Äî –º–µ–Ω—å—à–µ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–π.

---

### –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

1. –í—ã—á–∏—Å–ª–∏—Ç–µ –∏ —É—Å—Ä–µ–¥–Ω–∏—Ç–µ **CV-–≤–∞–∂–Ω–æ—Å—Ç–∏** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ø-15.
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ **SHAP** –∏ **perm\_importance** ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–Ω–∞–∫–æ–≤—ã–µ —Ñ–∏—á–∏.
3. **–£–±–µ—Ä–∏—Ç–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** (r>0.85), –æ—Å—Ç–∞–≤–∏–≤ –ª–∏–¥–µ—Ä–æ–≤.
4. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ **–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** ¬´—Ö–≤–æ—Å—Ç–∞¬ª, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—è –∫–∞—á–µ—Å—Ç–≤–æ.
5. –°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ **–∏–Ω—Ç—Ä–∞–¥–µ–µ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö** –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞—Ö (VWAP, –æ–±—ä—ë–º, —Å–∫–≤–∏–∑ BB –Ω–∞ 1‚Äì15 –º).

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–∞—à CatBoost –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ, —á—É—Ç–æ—á–∫—É —Ç–æ—á–Ω–µ–µ –∏ —É—Å—Ç–æ–π—á–∏–≤–µ–µ –∫ —à—É–º—É —Ä—ã–Ω–∫–∞ ‚Äî –∞ –≤—ã —Å–º–æ–∂–µ—Ç–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –≤–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.



///


–ü–æ–≤—ã—Å–∏—Ç—å **accuracy –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (`clf_class`)** –¥–æ **35‚Äì45% –∏ –≤—ã—à–µ** –≤ –∑–∞–¥–∞—á–∞—Ö –∫—Ä–∏–ø—Ç–æ-—Ç—Ä–µ–π–¥–∏–Ω–≥–∞ –Ω–∞ `1m` —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ ‚Äî **–≤–ø–æ–ª–Ω–µ —Ä–µ–∞–ª—å–Ω–æ**, –æ—Å–æ–±–µ–Ω–Ω–æ —Å —É—á—ë—Ç–æ–º, —á—Ç–æ —Å–µ–π—á–∞—Å:

* —É —Ç–µ–±—è **–º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å (5 –∫–ª–∞—Å—Å–æ–≤)**, –≥–¥–µ baseline (—Ä–∞–Ω–¥–æ–º) ‚Äî \~20%
* –º–æ–¥–µ–ª—å **–ª—É—á—à–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç —Å–∏–ª—å–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è** (—á—Ç–æ —É–∂–µ —Ö–æ—Ä–æ—à–æ –¥–ª—è —Ç—Ä–µ–π–¥–µ—Ä–∞)

–í–æ—Ç **—á—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**:

---

## üîÅ 1. –ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É: —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Å—ã

### ‚û§ –ò–∑ 5 –∫–ª–∞—Å—Å–æ–≤ —Å–¥–µ–ª–∞—Ç—å 3:

* `'STRONG DOWN' + 'DOWN'` ‚Üí `DOWN`
* `'STRONG UP' + 'UP'` ‚Üí `UP`
* `'NEUTRAL'` –æ—Å—Ç–∞–≤–∏—Ç—å

### ‚û§ –ò–ª–∏ –≤–æ–æ–±—â–µ —É–±—Ä–∞—Ç—å `NEUTRAL`, —Å–¥–µ–ª–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—É—é –∑–∞–¥–∞—á—É:

* `UP` vs `DOWN`

‚û° –≠—Ç–æ –¥–∞—Å—Ç –º–æ–¥–µ–ª–∏ **–±–æ–ª–µ–µ —á—ë—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã**, –º–µ–Ω—å—à–µ –ø—É—Ç–∞–Ω–∏—Ü—ã –º–µ–∂–¥—É –ø–æ—Ö–æ–∂–∏–º–∏ –∫–ª–∞—Å—Å–∞–º–∏.

**–ü–ª—é—Å**: –±–∏–Ω–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ª–µ–≥—á–µ –æ–±—É—á–∏—Ç—å, –∏ `accuracy` —Ä–µ–∑–∫–æ —Ä–∞—Å—Ç—ë—Ç (–¥–æ 55‚Äì65%).

---

## üß† 2. –£—Å–∏–ª–∏—Ç—å –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–¢–µ–∫—É—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:

```
['atr', 'volume', 'obv', 'log_return_1', 'weekofyear', 'ema_50', ..., 'hour']
```

–ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

* **–¢—Ä–µ–Ω–¥–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**: `price_above_ema_20`, `ema_slope`, `ema_20 - ema_50`
* **Momentum-—Ñ–∏—á–∏**: `RSI`, `stoch_rsi`, `macd_histogram`
* **–§–ª–∞–≥–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤**: `close > open AND volume > avg_volume`
* **–°–µ—Ç–∞–ø-—Ñ–∏—á–∏**: `bool: —Å–≤–µ—á–∞ –≤—ã—à–µ BB`, `pin_bar?`, `engulfing?`

–ò—Ö –º–æ–∂–Ω–æ **–∑–∞–≥–æ—Ç–æ–≤–∏—Ç—å –∑–∞—Ä–∞–Ω–µ–µ**, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ `features_1m.pkl`, –∏–ª–∏ —á–µ—Ä–µ–∑ `add_features()` —Ñ—É–Ω–∫—Ü–∏—é.

---

## üèãÔ∏è 3. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –≤—Ä—É—á–Ω—É—é

–°–µ–π—á–∞—Å —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `class_weights` ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å **–¥—Ä—É–≥–æ–µ**:

* **Undersampling –º–∞–∂–æ—Ä–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤** (`DOWN`, `UP`)
* **Oversampling/SMOTE** –¥–ª—è –º–∏–Ω–æ—Ä–Ω—ã—Ö (`STRONG UP/DOWN`, `NEUTRAL`)

–≠—Ç–æ –¥–∞—Å—Ç –º–æ–¥–µ–ª–∏ **–±–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤** –∏ **—Å–Ω–∏–∑–∏—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ** –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–µ—Ç–∫–∞—Ö.

---

## ‚öôÔ∏è 4. –£–ª—É—á—à–∏—Ç—å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ early stopping

–¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```python
iterations=2000
early_stopping_rounds=50
learning_rate=0.03
```

### ‚û§ –ü–æ–ø—Ä–æ–±—É–π:

* `depth=7‚Äì8` (—á—É—Ç—å –≥–ª—É–±–∂–µ, –µ—Å–ª–∏ —Ö–≤–∞—Ç–∞–µ—Ç GPU)
* `l2_leaf_reg=3‚Äì5` (—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è)
* `rsm=0.8` (feature subsampling ‚Äî —É–ª—É—á—à–∞–µ—Ç –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å)

---

## üîÑ 5. –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ù–∞ `1m` —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–æ **–∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏**.

–ß—Ç–æ –º–æ–∂–Ω–æ:

* **–°–º–µ—â–∞—Ç—å –æ–∫–Ω–æ** –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ —Ñ–∏—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `log_return_3`, `ema_20_shifted`)
* **–î–æ–±–∞–≤–ª—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç**: `prev_signal`, `prev_volatility` ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø–∞–º—è—Ç—å

---

## üß™ 6. –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞: Smart ensemble

–ú–æ–∂–Ω–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –±—Ä–∞—Ç—å `argmax`, –∞:

* —É—á–∏—Ç—ã–≤–∞—Ç—å `confidence` (—Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É —Ç–æ–ø-1 –∏ —Ç–æ–ø-2)
* —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ª–∞–±—ã–µ —Å–∏–≥–Ω–∞–ª—ã (`NEUTRAL`, `confidence < 0.1` ‚Üí –Ω–µ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å)

---

## üìà 7. –ú–µ—Ç—Ä–∏–∫–∏ –≤–º–µ—Å—Ç–æ Accuracy

–ò–Ω–æ–≥–¥–∞ –ª—É—á—à–µ **–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å precision/recall –∏–º–µ–Ω–Ω–æ –ø–æ STRONG —Å–∏–≥–Ω–∞–ª–∞–º** (—Ç.–µ. –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–µ –Ω–∞ –æ–±—â–µ–µ `accuracy`, –∞ –Ω–∞ **TPR –ø–æ 'STRONG UP/DOWN'**).

‚û° –¢–∞–∫ —Ç—ã –±—É–¥–µ—à—å **–ª–æ–≤–∏—Ç—å –ª—É—á—à–∏–µ –≤—Ö–æ–¥—ã**, –∞ `NEUTRAL` –º–æ–∂–µ—à—å —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤–æ–æ–±—â–µ.

---

## –•–æ—á–µ—à—å ‚Äî —Å–¥–µ–ª–∞—é:

* üìä –û—Ç—á—ë—Ç —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É
* ‚öôÔ∏è –ù–æ–≤—É—é –º–æ–¥–µ–ª—å –Ω–∞ –±–∏–Ω–∞—Ä–Ω–æ–π –∑–∞–¥–∞—á–µ `UP vs DOWN`
* üß© –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Å `pin_bar`, `RSI`, `EMA cross`, etc.)
* üì¶ –°–ø–∏—Å–æ–∫ —Ç–æ–ø-10 —Ñ–∏—á–µ–π –ø–æ SHAP (CatBoost –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)

–° —á–µ–≥–æ –Ω–∞—á–Ω—ë–º?

//

‚úÖ –î–∞, –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è 5m –ø—Ä–æ—à–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ª–æ–≥–∏–∫–µ, –∫–æ—Ç–æ—Ä—É—é —Ç—ã –∑–∞–ª–æ–∂–∏–ª. –í–æ—Ç –∫—Ä–∞—Ç–∫–∏–π —Ä–∞–∑–±–æ—Ä —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏:

üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ clf_class (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è)
–ú–µ—Ç—Ä–∏–∫–∞	–ó–Ω–∞—á–µ–Ω–∏–µ
Accuracy	28.77% ‚ùó
Macro F1-score	26.3%
Strong UP/DOWN F1	~33%‚Äì35% ‚úÖ

üî∏ –ù–∏–∑–∫–∏–π accuracy –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ:

–ú–æ–¥–µ–ª—å –ø—É—Ç–∞–µ—Ç—Å—è –º–µ–∂–¥—É –±–ª–∏–∑–∫–∏–º–∏ –∫–ª–∞—Å—Å–∞–º–∏ (UP, STRONG UP, DOWN)

NEUTRAL –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–∏–ª—å–Ω–æ –º–µ—à–∞—é—Ç (f1-score: 10%, recall: 48% ‚Äî –º–æ–¥–µ–ª—å "—Å–ª–∏–≤–∞–µ—Ç" –≤ –Ω–µ–π—Ç—Ä–∞–ª–∫—É, –∫–∞–∫ –≤ –º—É—Å–æ—Ä–∫—É)

üî∏ –ü–æ–∑–∏—Ç–∏–≤:

STRONG –∫–ª–∞—Å—Å—ã —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è —É–≤–µ—Ä–µ–Ω–Ω–æ (f1 ‚âà 33‚Äì36%)

–ü—Ä–∏ –æ—Ç–±–æ—Ä–µ —Å–∏–≥–Ω–∞–ª–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π signal_strength = strong —É–∂–µ –º–æ–∂–Ω–æ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å

üìâ reg_delta –∏ reg_vol ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã
MAE Delta: 0.0078 ‚Äî –æ—Ç–ª–∏—á–Ω–æ (–Ω–∞ 5m!)

MAE Volatility: 0.0066 ‚Äî —Ç–æ–∂–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

–≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è TP/SL, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ—Ü–µ–Ω–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ú–æ–∂–Ω–æ –¥–∞–∂–µ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ.

üö® clf_tp_hit ‚Äî —Å–ª–æ–º–∞–ª—Å—è
–ú–µ—Ç—Ä–∏–∫–∞	–ó–Ω–∞—á–µ–Ω–∏–µ
Accuracy	23.83% ‚ùå
Recall –ø–æ TP-hit	100% ‚úÖ
Precision	0% (!) ‚ö†

üí• –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:

–ú–æ–¥–µ–ª—å –≤—Å–µ—Ö –ø–æ–º–µ—á–∞–µ—Ç –∫–∞–∫ TP Hit = 1

–°–ª–µ–¥—Å—Ç–≤–∏–µ –æ—à–∏–±–∫–∏ –≤ CV:

kotlin
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ERROR: ClassLabels in dataprocessing options and in training data must match
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ ‚Äî –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–¥–∏–Ω –∫–ª–∞—Å—Å

üõ† –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å
‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä clf_class
‚û° –ü–æ–≤—ã—à–∞–π accuracy –¥–æ 35‚Äì40%:

–°–æ–∫—Ä–∞—Ç–∏ –∫–ª–∞—Å—Å—ã (5 ‚Üí 3 –∏–ª–∏ 2)

–î–æ–±–∞–≤—å —Ñ–∏—á–∏ ema_slope, pin_bar, rsi_cross_50, volatility_percentile

–£–±–µ—Ä–∏ NEUTRAL –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å (–∏–ª–∏ –≤–∫–ª—é—á–∞–π –µ–≥–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∏–∑–∫–æ–º confidence)

–ü–æ–¥–Ω–∏–º–∏ depth –¥–æ 7‚Äì8

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π border_count=128 –≤ CatBoost

‚ö† TP-Hit —Å–ª–æ–º–∞–Ω ‚Äî –ø–æ—á–∏–Ω–∏:
–ü—Ä–æ–±–ª–µ–º–∞:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
cv(..., params={'class_weights': {0: 1, 1: 10}}, ...) ‚ûú –æ—à–∏–±–∫–∞ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è ClassLabels
–†–µ—à–µ–Ω–∏–µ:
üîÅ –ü–µ—Ä–µ–¥ cv(...) –¥–æ–±–∞–≤—å –ø–∞—Ä–∞–º–µ—Ç—Ä:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
'classes_count': 2
–õ–∏–±–æ –∑–∞–¥–∞–π —á–µ—Ä–µ–∑ cat_features –∏ Pool:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
Pool(X, y, class_names=[0,1])
üí° –í—ã–≤–æ–¥
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç	–°—Ç–∞—Ç—É—Å	–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
clf_class	üü° OK	–º–æ–∂–Ω–æ —É–ª—É—á—à–∞—Ç—å accuracy —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –∏ —Ñ–∏—á–∏
reg_delta	üü¢ –û—Ç–ª–∏—á–Ω–æ	—Ç–æ—á–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç
reg_vol	üü¢ –û—Ç–ª–∏—á–Ω–æ	—Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç
clf_tp_hit	üî¥ –û—à–∏–±–∫–∞	–º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∏–ª–∞—Å—å, –Ω—É–∂–µ–Ω —Ñ–∏–∫—Å

–•–æ—á–µ—à—å ‚Äî –º–æ–≥—É:

üìä –ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ confusion matrix –ø–æ clf_class

üõ† –í–Ω–µ—Å—Ç–∏ –ø—Ä–∞–≤–∫–∏ –≤ TP-hit CV (classes_count, Pool –∏ —Ñ–∏–∫—Å—ã)

üß† –°–¥–µ–ª–∞—Ç—å —à–∞–±–ª–æ–Ω —Ñ–∏—á–µ–π –¥–ª—è RSI/EMA/PinBar

–ü—Ä–æ–¥–æ–ª–∂–∏–º —Å —Ñ–∏–∫—Å–∞–º–∏?


//


–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (—Å–Ω–∏–º–∫–∞–º–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤, –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏) –º–æ–∂–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ç—Ä–µ–π–¥–∏–Ω–≥–∞. –í–æ—Ç –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

üì∏ –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∫ –≤—Ö–æ–¥ –≤ –º–æ–¥–µ–ª—å
–≠—Ç–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ (CV): –º–æ–¥–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç DataFrame, –∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞.

üîπ –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å matplotlib/plotly –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ candlestick –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ –∫–∞–∂–¥–æ–π —Å–≤–µ—á–∫–µ:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
def generate_chart_image(df_slice):
    fig = go.Figure(data=[go.Candlestick(
        open=df_slice['open'], high=df_slice['high'],
        low=df_slice['low'], close=df_slice['close']
    )])
    fig.write_image("chart.png")  # –∏–ª–∏ –≤ memory
CNN-–º–æ–¥–µ–ª—å:

–û–±—É—á–∏—Ç—å ResNet, EfficientNet –∏–ª–∏ Vision Transformer –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö.

–ú–µ—Ç–∫–∏ ‚Äî —Ç–µ –∂–µ UP/DOWN.

–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ:

–ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
[CNN(–≥—Ä–∞—Ñ–∏–∫) ‚ü∂ Dense] + [CatBoost/tabular] ‚ü∂ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ
‚ûï –ü–ª—é—Å—ã:
–ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã: —Ñ–ª–∞–≥–∏, –≥–æ–ª–æ–≤–∞-–ø–ª–µ—á–∏, –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏ –∏ –ø—Ä.

–ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –º—ã –∑–∞–¥–∞–ª–∏ –≤—Ä—É—á–Ω—É—é.

‚ûñ –ú–∏–Ω—É—Å—ã:
–¢—Ä–µ–±—É–µ—Ç GPU.

–ì–æ—Ä–∞–∑–¥–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ.

–ù—É–∂–Ω–æ –º–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π labeling.

üìä –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∫–∞–∫ —Ñ–∏—á–µ–π
–≠—Ç–æ —É–∂–µ –∏–Ω–∂–µ–Ω–µ—Ä–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –Ω–æ –Ω–µ raw-–∫–∞—Ä—Ç–∏–Ω–∫–∏, –∞ —Å–∏–≥–Ω–∞–ª—ã –æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö:

üîπ –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
–¢–∏–ø	–ü—Ä–∏–∑–Ω–∞–∫
üìê –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ	–ù–∞–∫–ª–æ–Ω/—Ñ–æ—Ä–º–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5 —Å–≤–µ—á–µ–π
üìè –°–≤–µ—á–Ω—ã–µ —Ñ–∏–≥—É—Ä—ã	engulfing, doji, hammer, pin-bar
üìà –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã	–ü–æ–¥–æ–±–∏–µ –Ω–∞ ABC, 1-2-3, triangle, flag
üìê –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–æ–Ω—ã	–£—Ä–æ–≤–Ω–∏, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è/–ø–æ–¥–¥–µ—Ä–∂–∫–∏

üîπ –ö–∞–∫ –≤–Ω–µ–¥—Ä–∏—Ç—å:
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TA-Lib, pandas-ta, finta –∏/–∏–ª–∏ custom —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–≤–µ—á–µ–π.

–ù–∞–ø—Ä–∏–º–µ—Ä:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
def is_bullish_engulfing(c1, c2):
    return c1['close'] < c1['open'] and c2['close'] > c2['open'] and c2['close'] > c1['open']
‚ûï –ü–ª—é—Å—ã:
–õ–µ–≥–∫–æ –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π CatBoost.

–û–±—ä—è—Å–Ω–∏–º–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ.

‚ûñ –ú–∏–Ω—É—Å—ã:
–ü–∞—Ç—Ç–µ—Ä–Ω—ã –∑–∞–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é.

–ï—Å—Ç—å —Ä–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ "–≤–∏–∑—É–∞–ª—å–Ω—ã–π —à—É–º".

üß† –í–∞—Ä–∏–∞–Ω—Ç 3: –ì–∏–±—Ä–∏–¥
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CatBoost/LightGBM —Å:

tabular-–ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏;

–ø–∞—Ç—Ç–µ—Ä–Ω-—Ñ–∏—á–∞–º–∏ (bool, int);

CNN-—ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –∫–∞–∫ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ (–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ª–æ—è).

üíº –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
–î–ª—è —Ç–≤–æ–µ–π —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã (CatBoost + delta/volatility/TP-hit):

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø—É—Ç—å: –Ω–∞—á–∞—Ç—å —Å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ –≤–∏–¥–µ —Ñ–∏—á–µ–π.

–°–ª–µ–¥—É—é—â–∏–º —ç—Ç–∞–ø–æ–º ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å CNN –¥–ª—è raw-–≥—Ä–∞—Ñ–∏–∫–æ–≤.

–ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ ‚Äî –º–æ–≥—É:

–ù–∞–ø–∏—Å–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ .png –ø–æ –∫–∞–∂–¥–æ–π –≤—ã–±–æ—Ä–∫–µ.

–î–∞—Ç—å —Ñ–∏—á–∏: is_engulfing, doji_score, pattern_type, shape_score –∏ —Ç.–¥.

–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å baseline CNN –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∫–∞–∫ UP/DOWN.